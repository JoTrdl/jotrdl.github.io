{"version":3,"sources":["0","../src/shadu.js","color-mixer/index.js"],"names":["module","exports","root","ShadU","DEVICE_PIXEL_RATIO","devicePixelRatio","get3DContext","canvas","options","names","context","i","length","getContext","e","createProgram","gl","vertex","fragment","vs","fs","program","compileShader","VERTEX_SHADER","FRAGMENT_SHADER","deleteProgram","attachShader","deleteShader","linkProgram","validateProgram","getProgramParameter","LINK_STATUS","info","getProgramInfoLog","Error","code","type","shader","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","lines","getShaderSource","split","src","getShaderInfoLog","createTexture","width","height","texture","format","RGBA","level","UNSIGNED_BYTE","border","min","minFilter","NEAREST","mag","magFilter","wrapS","CLAMP_TO_EDGE","wrapT","data","flipY","preAlpha","FLOAT","extensions","getSupportedExtensions","indexOf","getExtension","LINEAR","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","TEXTURE_WRAP_T","pixelStorei","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","ArrayBuffer","texImage2D","DEFAULT_VERTEX_SHADER","join","HEADER_FRAGMENT_SHADER","BODY_FRAGMENT_SHADER","DEFAULT_FRAGMENT_SHADER","PAINT_VERTICES","Float32Array","PAINT_VERTICES_LENGTH","applyUniform","location","value","uLocation","getUniformLocation","values","call","textures","t","isShadUTexture","output","activeTexture","TEXTURE0","args","concat","apply","applyAttribute","size","buffer","locationId","getAttribLocation","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","bindAttribLocation","vertexAttribPointer","enableVertexAttribArray","Texture","WebGLRenderingContext","offsetWidth","offsetHeight","viewportWidth","viewportHeight","uResolution","reset","console","log","prototype","keepOutput","shaders","attributes","uniforms","frameBuffer","createFramebuffer","frame","time","quadBuffer","createBuffer","paintShader","quadVertices","geometryBuffer","vertices","arrays","TRIANGLE_STRIP","geometry","vertexFragment","userUniforms","userAttributes","a","push","image","sampler","paint","useProgram","bindFramebuffer","FRAMEBUFFER","uniform1i","viewport","drawArrays","resize","render","index","input","textureUnit","Date","now","callback","out","framebufferTexture2D","COLOR_ATTACHMENT0","uniform1f","uniform3f","u","iterate","count","uniform","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","write","xoffset","yoffset","UNSIGNED_SHORT","Uint8Array","UNSIGNED_INT","Int32Array","texSubImage2D","factory","define","amd","CANVAS_RECT","document","getElementById","preserveDrawingBuffer","colors","base","additive","theta","amount","rtt","updateCanvasRect","rect","getBoundingClientRect","left","window","scrollX","top","scrollY","addEventListener","getCoords","x","clientX","y","clientY","getKnobCoords","w","h","Math","cos","sin","getKnobTheta","coords","atan2","PI","knob","querySelector","setKnob","pos","style","opacity","getBaseColor","drawingBufferWidth","drawingBufferHeight","pixels","readPixels","r","g","b","rgbToHex","toString","slice","getLuminance","updateOutputColor","col","l","v","backgroundColor","innerHTML","color","borderColor","boxShadow","thetaLast","thetaStart","TOTAL","STEPS","renderMixer","diff","abs","dir","sign","steps","round","requestAnimationFrame","onMouseMove","preventDefault","classList","remove","removeEventListener","add","querySelectorAll","forEach","el","target","rgb","m","getComputedStyle","match"],"mappings":"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","file":"color-mixer.7203090d.map","sourceRoot":"../showcases","sourcesContent":[null,"/*! shadu v1.0.0 | (c) 2018 Johann Troendle | https://github.com/JoTrdl/shadu.git */\n/**\n * ShadU module.\n * @namespace ShadU\n */\n;(function (root) {\n  'use strict'\n\n  var ShadU = {}\n\n  var DEVICE_PIXEL_RATIO = (typeof devicePixelRatio !== 'undefined' && devicePixelRatio) || 1\n\n  /**\n   * @function get3DContext\n   * @memberof ShadU\n   * @static\n   *\n   * Get a 3d context from the canvas\n   * Pass options to the canvas.getContext() function.\n   *\n   * @param  {HTMLCanvasElement}      canvas  The canvas element\n   * @param  {Object}                 options Options to pass to getContext()\n   * @return {WebGLRenderingContext}  The WebGL context or null if not supported\n   */\n  ShadU.get3DContext = function (canvas, options) {\n    var names = ['webgl', 'experimental-webgl']\n    var context = null\n\n    for (var i = 0; i < names.length; i++) {\n      try {\n        context = canvas.getContext(names[i], options)\n      } catch (e) {}\n      if (context) {\n        break\n      }\n    }\n    return context\n  }\n\n  /**\n   * @function createProgram\n   * @memberof ShadU\n   * @static\n   *\n   * Create a GL program.\n   *\n   * @param  {WebGLRenderingContext} gl        WebGL context\n   * @param  {String}                vertex    Vertex code\n   * @param  {String}                fragment  Fragment code\n   * @return {Program}                         The program compiled & linked.\n   */\n  ShadU.createProgram = function (gl, vertex, fragment) {\n    var vs\n    var fs\n    var program = gl.createProgram()\n\n    try {\n      vs = this.compileShader(gl, vertex, gl.VERTEX_SHADER)\n      fs = this.compileShader(gl, fragment, gl.FRAGMENT_SHADER)\n    } catch (e) {\n      gl.deleteProgram(program)\n      throw e\n    }\n\n    gl.attachShader(program, vs)\n    gl.deleteShader(vs)\n    gl.attachShader(program, fs)\n    gl.deleteShader(fs)\n    gl.linkProgram(program)\n    gl.validateProgram(program)\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n      var info = gl.getProgramInfoLog(program)\n      throw new Error('Could not compile WebGL program:\\n' + info)\n    }\n\n    return program\n  }\n\n  /**\n   * @function compileShader\n   * @memberof ShadU\n   * @static\n   *\n   * Compile the shader.\n   *\n   * @param  {WebGLRenderingContext} gl   WebGL context\n   * @param  {String}                code Shader code\n   * @param  {Int}                   type Shader type (gl.VERTEX_SHADER | gl.FRAGMENT_SHADER)\n   * @return {Shader}                Compiled shader\n   */\n  ShadU.compileShader = function (gl, code, type) {\n    var shader = gl.createShader(type)\n\n    gl.shaderSource(shader, code)\n    gl.compileShader(shader)\n\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n      var lines = gl.getShaderSource(shader).split('\\n')\n      var src = ''\n      for (var i = 0; i < lines.length; i++) {\n        src += (i + 1) + '.' + lines[i] + '\\n'\n      }\n      throw new Error('GLSL Compilation Error:\\n' + gl.getShaderInfoLog(shader) + '\\n' + src)\n    }\n\n    return shader\n  }\n\n  /**\n   * @function createTexture\n   * @memberof ShadU\n   * @static\n   *\n   * Create an empty texture.\n   *\n   * @param  {WebGLRenderingContext} gl      WebGL context\n   * @param  {Number}                width   Width\n   * @param  {Number}                height  Height\n   * @param  {Object}                options Extra options\n   * @return {Texture}                       The texture\n   */\n  ShadU.createTexture = function (gl, width, height, options) {\n    var texture = gl.createTexture()\n\n    // save infos in texture for future bindings\n    var format = texture.format = (options && options.format) || gl.RGBA\n    var level = texture.level = (options && options.level) || 0\n    var type = texture.type = (options && options.type) || gl.UNSIGNED_BYTE\n    var border = texture.border = (options && options.border) || 0\n    var min = (options && options.minFilter) || gl.NEAREST\n    var mag = (options && options.magFilter) || gl.NEAREST\n    var wrapS = (options && options.wrapS) || gl.CLAMP_TO_EDGE\n    var wrapT = (options && options.wrapT) || gl.CLAMP_TO_EDGE\n    var data = (options && options.data) || null\n    var flipY = (options && options.flipY) || false\n    var preAlpha = (options && options.preAlpha) || false\n    // var colorConvsersion = (options && options.colorConvsersion) || gl.BROWSER_DEFAULT_WEBGL\n\n    if (type === gl.FLOAT) {\n      var extensions = gl.getSupportedExtensions()\n      if (extensions.indexOf('OES_texture_float') < 0) {\n        throw new Error('Type gl.FLOAT is not supported.')\n      }\n      // else activate the float extension\n      gl.getExtension('OES_texture_float')\n\n      if (min === gl.LINEAR || mag === gl.LINEAR) {\n        if (extensions.indexOf('OES_texture_float_linear') < 0) {\n          throw new Error('Type gl.FLOAT with filter gl.LINEAR is not supported.')\n        }\n        // else activate the float_linear extension\n        gl.getExtension('OES_texture_float_linear')\n      }\n    }\n\n    gl.bindTexture(gl.TEXTURE_2D, texture)\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, mag)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, min)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, wrapS)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, wrapT)\n\n    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, flipY)\n    gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, preAlpha)\n\n    if (!data || data instanceof ArrayBuffer) {\n      gl.texImage2D(gl.TEXTURE_2D, level, format, width, height, border, format, type, data)\n    } else {\n      gl.texImage2D(gl.TEXTURE_2D, level, format, format, type, data)\n    }\n\n    gl.bindTexture(gl.TEXTURE_2D, null)\n\n    return texture\n  }\n\n  /**\n   * The default vertex.\n   * @type {String}\n   */\n  var DEFAULT_VERTEX_SHADER = [\n    'attribute vec2 position;',\n    'varying vec2 uv;',\n\n    'void main() {',\n    '  uv = position;',\n    '  vec2 pos = position * 2.0 - 1.0;',\n    '  gl_Position = vec4(pos.x, pos.y, 0, 1);',\n    '}'\n  ].join('\\n')\n\n  var HEADER_FRAGMENT_SHADER = [\n    '#ifdef GL_FRAGMENT_PRECISION_HIGH',\n    '  precision highp float;',\n    '#else',\n    '  precision mediump float;',\n    '#endif',\n\n    'uniform sampler2D sampler;',\n    'uniform vec3 resolution;',\n    'uniform int frame;',\n    'uniform float time;',\n    'varying vec2 uv;'\n  ].join('\\n')\n\n  var BODY_FRAGMENT_SHADER = [\n    'void main() {',\n    '  gl_FragColor = texture2D(sampler, uv);',\n    '}'\n  ].join('\\n')\n\n  /**\n   * The default fragment to paint in buffer.\n   * @type {String}\n   */\n  var DEFAULT_FRAGMENT_SHADER = [\n    HEADER_FRAGMENT_SHADER,\n    BODY_FRAGMENT_SHADER\n  ].join('\\n')\n\n  /**\n   * 2 triangles (plane) for painting the result\n   * @type {Float32Array}\n   */\n  var PAINT_VERTICES = new Float32Array([\n    -1.0, -1.0,\n    1.0, -1.0,\n    -1.0, 1.0,\n    1.0, -1.0,\n    1.0, 1.0,\n    -1.0, 1.0\n  ])\n\n  /**\n   * Pre-compute VERTICES length\n   * @type {Number}\n   */\n  var PAINT_VERTICES_LENGTH = PAINT_VERTICES.length / 2\n\n  /**\n   * Apply uniform.\n   *\n   * @param  {Object} gl       GL context\n   * @param  {Object} shader   Shader program\n   * @param  {Object} type     GL uniform type or 't' for texture\n   * @param  {String} location Uniform name\n   * @param  {Object} value    Value to set\n   * @param  {Object} texture  Web GL texture if type is 't'\n   */\n  var applyUniform = function (gl, shader, type, location, value, texture) {\n    var uLocation = gl.getUniformLocation(shader, location)\n\n    if (value === null || !uLocation) {\n      return\n    }\n\n    var values = (value.length) ? value : [value]\n\n    if (!texture) {\n      var args = [uLocation].concat(values)\n      type.apply(gl, args)\n    } else { // texture to bind\n      type.call(gl, uLocation, value)\n\n      var textures = (texture.length) ? texture : [texture]\n      var t\n      for (var i = 0; i < textures.length; i++) {\n        t = (textures[i].isShadUTexture && textures[i].output) || textures[i]\n        gl.activeTexture(gl.TEXTURE0 + values[i])\n        gl.bindTexture(gl.TEXTURE_2D, t)\n      }\n    }\n  }\n\n  /**\n   * Apply attribute.\n   *\n   * @param  {Object} gl       GL context\n   * @param  {Object} shader   Shader program\n   * @param  {String} location Location name\n   */\n  var applyAttribute = function (gl, shader, location, size, buffer, data) {\n    var locationId = gl.getAttribLocation(shader, location)\n\n    if (locationId < 0) {\n      return\n    }\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffer)\n    gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW)\n\n    gl.bindAttribLocation(shader, locationId, 'position')\n    gl.vertexAttribPointer(locationId, size, gl.FLOAT, false, 0, 0)\n    gl.enableVertexAttribArray(locationId)\n  }\n\n  /**\n   * @class Texture\n   * @constructor\n   * @memberof ShadU\n   * @static\n   *\n   * Texture constructor\n   * @param {WebGLRenderingContext} gl      WebGL context for rendering\n   * @param {Object}                options Object of options.\n   */\n  var Texture = ShadU.Texture = function (gl, options) {\n    this.isShadUTexture = true\n    this.options = options || {}\n    this.gl = gl\n\n    if (!(gl && gl instanceof WebGLRenderingContext)) {\n      console.log('Error, paramater [gl] must be a WebGL context')\n      return\n    }\n\n    // Init texture size\n    this.width = (this.options.width || gl.canvas.offsetWidth) * DEVICE_PIXEL_RATIO\n    this.height = (this.options.height || gl.canvas.offsetHeight) * DEVICE_PIXEL_RATIO\n\n    // Init viewport size\n    this.viewportWidth = this.options.viewportWidth || gl.canvas.width\n    this.viewportHeight = this.options.viewportHeight || gl.canvas.height\n\n    this.uResolution = [this.width / this.height, 1.0, DEVICE_PIXEL_RATIO]\n\n    this.reset()\n  }\n\n  /**\n   * Reset the Texture\n   *\n   * @return {TextureInstance}  this\n   */\n  Texture.prototype.reset = function (keepOutput) {\n    var gl = this.gl\n    this.shaders = [] // Shaders list\n    this.attributes = [] // Atrributes list\n    this.uniforms = [] // Uniforms list\n\n    // Framebuffer & Ping-Pong textures\n    this.frameBuffer = gl.createFramebuffer()\n    this.textures = [\n      ShadU.createTexture(gl, this.width, this.height, this.options.texture),\n      ShadU.createTexture(gl, this.width, this.height, this.options.texture)\n    ]\n\n    this.frame = 0\n    this.time = 0\n    this.output = (keepOutput !== true && this.textures[0]) || this.output\n\n    // Paint buffer & shader\n    this.quadBuffer = gl.createBuffer()\n    this.paintShader = ShadU.createProgram(gl, DEFAULT_VERTEX_SHADER, DEFAULT_FRAGMENT_SHADER)\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.quadBuffer)\n    this.quadVertices = new Float32Array(PAINT_VERTICES)\n\n    this.geometryBuffer = this.quadBuffer\n    this.vertices = this.quadVertices\n    this.arrays = [gl.TRIANGLE_STRIP, 0, PAINT_VERTICES_LENGTH] // default to quad\n\n    // Process custom geometry\n    if (this.options.geometry) {\n      this.vertices = this.options.geometry.vertices\n      this.arrays = this.options.geometry.arrays\n    }\n\n    return this\n  }\n\n  /**\n   * Add a new fragment in the Texture chain with DEFAULT_VERTEX_SHADER vertex.\n   *\n   * @param  {String} fragmentShader  The fragment shader\n   * @return {TextureInstance}        this\n   */\n  Texture.prototype.fragment = function (fragment, uniforms) {\n    return this.vertexFragment(DEFAULT_VERTEX_SHADER, fragment, uniforms)\n  }\n\n  /**\n   * Add a new vertex/fragment in the Texture chain.\n   *\n   * @param  {String} vertexShader   The vertext shader\n   * @param  {String} fragmentShader The fragment shader\n   * @return {TextureInstance}       this\n   */\n  Texture.prototype.vertexFragment = function (vertex, fragment, userUniforms, userAttributes) {\n    var shader = ShadU.createProgram(this.gl, vertex, HEADER_FRAGMENT_SHADER + '\\n' + fragment)\n\n    this.shaders.push(shader)\n    this.uniforms.push(userUniforms || {})\n\n    // Init buffers before pushing on stack\n    for (var a in userAttributes) {\n      userAttributes[a].buffer = this.gl.createBuffer()\n    }\n\n    this.attributes.push(userAttributes || {})\n\n    return this\n  }\n\n  /**\n   * Render an image on the chain.\n   *\n   * @param  {Boolean} flipY    Flip the Y axis, default to true\n   * @return {TextureInstance}  this\n   */\n  Texture.prototype.image = function (image, flipY) {\n    var texture = ShadU.createTexture(this.gl, this.width, this.height, {\n      flipY: flipY || true,\n      data: image\n    })\n    var uniforms = {\n      sampler: { type: 't', value: texture }\n    }\n\n    return this.vertexFragment(DEFAULT_VERTEX_SHADER, BODY_FRAGMENT_SHADER, uniforms)\n  }\n\n  /**\n   * Paint the Texture on the screen buffer.\n   * @return {TextureInstance} this\n   */\n  Texture.prototype.paint = function () {\n    if (!this.output) {\n      console.log('Error: no output to paint. Call render() at least once.')\n      return this\n    }\n\n    var gl = this.gl\n\n    gl.useProgram(this.paintShader)\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null)\n\n    applyAttribute(gl, this.paintShader, 'position', 2, this.quadBuffer, this.quadVertices)\n    applyUniform(gl, this.paintShader, gl.uniform1i, 'sampler', 0, this.output)\n\n    gl.viewport(0, 0, this.viewportWidth, this.viewportHeight)\n    gl.drawArrays(gl.TRIANGLE_STRIP, 0, PAINT_VERTICES_LENGTH)\n\n    return this\n  }\n\n  /**\n   * Resize the Texture\n   *\n   * @param  {Number} width          New texture width, default canvas.width\n   * @param  {Number} height         New texture height, default canvas.height\n   * @param  {Number} viewportWidth  New viewport width, default canvas.width\n   * @param  {Number} viewportHeight News viewport height, default canvas.height\n   * @return {TextureInstance}       this\n   */\n  Texture.prototype.resize = function (width, height, viewportWidth, viewportHeight) {\n    var gl = this.gl\n\n    this.width = width || (gl.canvas.offsetWidth * DEVICE_PIXEL_RATIO)\n    this.height = height || (gl.canvas.offsetHeight * DEVICE_PIXEL_RATIO)\n    this.viewportWidth = viewportWidth || gl.canvas.width\n    this.viewportHeight = viewportHeight || gl.canvas.height\n\n    this.uResolution = [this.width / this.height, 1.0, DEVICE_PIXEL_RATIO]\n\n    for (var i = 0; i < this.textures.length; i++) {\n      var t = this.textures[i]\n      gl.bindTexture(gl.TEXTURE_2D, t)\n      gl.texImage2D(gl.TEXTURE_2D, t.level, t.format, this.width, this.height, t.border, t.format, t.type, null)\n    }\n\n    return this\n  }\n\n  /**\n   * Render the texture.\n   *\n   * @return {TextureInstance}  this\n   */\n  Texture.prototype.render = function () {\n    var gl = this.gl\n    var i\n    var index\n    var input\n    var textureUnit\n\n    this.time = Date.now() * 0.001\n\n    for (i = 0; i < this.shaders.length; i++) {\n      textureUnit = 0\n\n      // Ping pong\n      input = this.output\n      index = (++this.frame) % 2\n      this.output = this.textures[index]\n\n      if (this.shaders[i].callback) {\n        var out = this.shaders[i].callback(input)\n        if (out) {\n          this.output = out\n          continue\n        }\n      }\n\n      // Bind program & framebuffer\n      gl.useProgram(this.shaders[i])\n      gl.bindFramebuffer(gl.FRAMEBUFFER, this.frameBuffer)\n      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.output, 0)\n\n      // apply default attribute/uniforms\n      applyAttribute(gl, this.shaders[i], 'position', 2, this.geometryBuffer, this.vertices)\n      applyUniform(gl, this.shaders[i], gl.uniform1i, 'sampler', textureUnit++, input)\n      applyUniform(gl, this.shaders[i], gl.uniform1i, 'frame', this.frame)\n      applyUniform(gl, this.shaders[i], gl.uniform1f, 'time', this.time)\n      applyUniform(gl, this.shaders[i], gl.uniform3f, 'resolution', this.uResolution)\n\n      // apply user attributes\n      for (var a in this.attributes) {\n        applyAttribute(gl, this.shaders[i], a, this.attributes[a].size, this.attributes[a].buffer, this.attributes[a].data)\n      }\n\n      // Apply user uniforns, take care of the custom 't' type for texture\n      for (var u in this.uniforms[i]) {\n        var type = gl['uniform' + this.uniforms[i][u].type]\n        var value = this.uniforms[i][u].value\n        var texture = null\n\n        if (this.uniforms[i][u].type === 't') {\n          type = gl.uniform1i\n          value = textureUnit++\n          texture = this.uniforms[i][u].value\n        }\n\n        applyUniform(gl, this.shaders[i], type, u, value, texture)\n      }\n\n      // Draw the shaders\n      gl.viewport(0, 0, this.width, this.height)\n      gl.drawArrays.apply(gl, this.arrays)\n    }\n\n    return this\n  }\n\n  /**\n   * Iterate the last program on the stack.\n   *\n   * @param  {Number} count Iterate count\n   * @return {TextureInstance} this\n   */\n  Texture.prototype.iterate = function (count) {\n    var shader = this.shaders[this.shaders.length - 1]\n    var uniform = this.uniforms[this.uniforms.length - 1]\n\n    for (var i = 0; i < count; i++) {\n      this.shaders.push(shader)\n      this.uniforms.push(uniform)\n    }\n\n    return this\n  }\n\n  /**\n   * Calbback hook\n   *\n   * @param  {Function} callback Iteration function\n   * @return {TextureInstance} this\n   */\n  Texture.prototype.callback = function (callback) {\n    this.fragment(BODY_FRAGMENT_SHADER)\n\n    var shader = this.shaders[this.shaders.length - 1]\n    shader.callback = callback\n\n    return this\n  }\n\n  /**\n   * Clear the framebuffer.\n   *\n   * @return {TextureInstance}  this\n   */\n  Texture.prototype.clear = function () {\n    if (!this.frame) { // Nothing to clear\n      return this\n    }\n\n    var gl = this.gl\n\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this.frameBuffer)\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT | gl.STENCIL_BUFFER_BIT)\n\n    return this\n  }\n\n  /**\n   * Write in the texture.\n   * This write in gl.RGBA format\n   *\n   * @return {TextureInstance}  this\n   */\n  Texture.prototype.write = function (xoffset, yoffset, width, height, type, data) {\n    var gl = this.gl\n\n    var buffer\n    switch (type) {\n      case gl.UNSIGNED_BYTE:\n      case gl.UNSIGNED_SHORT:\n        buffer = new Uint8Array(data)\n        break\n      case gl.FLOAT:\n        buffer = new Float32Array(data)\n        break\n      case gl.UNSIGNED_INT:\n      default:\n        buffer = new Int32Array(data)\n    }\n\n    gl.bindTexture(gl.TEXTURE_2D, this.output)\n    gl.texSubImage2D(gl.TEXTURE_2D, 0, xoffset, yoffset, width, height, gl.RGBA, type, buffer)\n  };\n\n  // Export\n  (function (root, factory) {\n    /* eslint-disable no-undef */\n    if (typeof define === 'function' && define.amd) {\n      define([], factory)\n    } else if (typeof exports === 'object') {\n      module.exports = factory()\n    } else {\n      root.ShadU = factory()\n    }\n  }(root, function () {\n    return ShadU\n  }))\n})(this)\n","import fragment from './fragment'\n\nimport ShadU from 'shadu'\n\nconst canvas = document.getElementById('canvas')\nlet CANVAS_RECT\n\nconst gl = ShadU.get3DContext(canvas, {\n  preserveDrawingBuffer: true\n})\n\nconst colors = {\n  base: [255 / 255, 220 / 255, 0 / 255],\n  additive: [0 / 255, 116 / 255, 217 / 255]\n}\n\nconst uniforms = {\n  theta: { type: '1f', value: 0 },\n  amount: { type: '1f', value: 0 },\n  base: { type: '3f', value: colors.base },\n  additive: { type: '3f', value: colors.additive }\n}\n\nconst rtt = new ShadU.Texture(gl)\n  .fragment(fragment, uniforms)\n  .render().paint()\n\nconst updateCanvasRect = () => {\n  const rect = canvas.getBoundingClientRect()\n  CANVAS_RECT = {\n    left: rect.left + window.scrollX,\n    top: rect.top + window.scrollY,\n    width: rect.width,\n    height: rect.height\n  }\n}\nwindow.addEventListener('resize', () => {\n  updateCanvasRect()\n})\nupdateCanvasRect()\n\n/*\nThe coords space is [0,0] to [1,1]\nwhere bottom-left is [0,0]\n\n0,1 ---------- 1,1\n|               |\n|       +       |\n|               |\n0,0 ---------- 1,0\n\n(x,y) = 2 * (x,y) - 1\n*/\nconst getCoords = e => {\n  const coords = {\n    x: (e.clientX - CANVAS_RECT.left) / CANVAS_RECT.width,\n    y: 1 - (e.clientY - CANVAS_RECT.top) / CANVAS_RECT.height\n  }\n\n  return {\n    x: coords.x * 2 - 1,\n    y: coords.y * 2 - 1\n  }\n}\n\nconst getKnobCoords = (theta, w, h) => {\n  const a = (Math.cos(theta) * 0.5 + 1) / 2\n  const b = (Math.sin(theta) * 0.5 + 1) / 2\n\n  return {\n    x: a * w,\n    y: (1 - b) * h\n  }\n}\n\nconst getKnobTheta = coords => {\n  let theta = Math.atan2(coords.y, coords.x)\n\n  return theta < 0\n    ? theta + 2 * Math.PI\n    : theta\n}\n\nconst knob = document.querySelector('#knob')\nconst setKnob = theta => {\n  const pos = getKnobCoords(theta, CANVAS_RECT.width, CANVAS_RECT.height)\n\n  knob.style.left = `${pos.x}px`\n  knob.style.top = `${pos.y}px`\n}\n\nsetKnob(0)\nknob.style.width = `${gl.canvas.offsetWidth * 0.5}px`\nknob.style.height = `${gl.canvas.offsetHeight * 0.5}px`\nknob.style.opacity = 1\n\nconst getBaseColor = () => {\n  const pos = getKnobCoords(\n    uniforms.theta.value,\n    gl.drawingBufferWidth, gl.drawingBufferHeight\n  )\n  var pixels = new Uint8Array(4)\n  gl.readPixels(\n    pos.x,\n    gl.drawingBufferHeight - pos.y,\n    1, 1,\n    gl.RGBA, gl.UNSIGNED_BYTE,\n    pixels)\n\n  return {\n    r: pixels[0],\n    g: pixels[1],\n    b: pixels[2]\n  }\n}\n\nconst output = document.querySelector('#output')\nconst rgbToHex = (r, g, b) => (\n  '#' + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1)\n)\nconst getLuminance = (r, g, b) => (0.299 * r + 0.587 * g + 0.114 * b)\nconst updateOutputColor = () => {\n  const col = getBaseColor()\n\n  const l = getLuminance(col.r, col.g, col.b)\n  const v = rgbToHex(col.r, col.g, col.b)\n  output.style.backgroundColor = output.innerHTML = v\n  output.style.color = l > 127 ? '#000' : '#fff'\n  knob.style.borderColor = l > 127 ? 'rgba(0,0,0,.75)' : 'rgba(255,255,255,.75)'\n  knob.style.boxShadow = l > 127 ? 'var(--knob-shadow-dark)' : 'var(--knob-shadow-light)'\n}\nupdateOutputColor()\n\nlet thetaLast = 0\nlet thetaStart = 0\nconst TOTAL = 2 * 2 * Math.PI\nconst STEPS = TOTAL / 360\n\nconst renderMixer = theta => {\n  let diff = Math.abs(thetaLast - theta)\n  if (diff > Math.PI) {\n    diff = 2 * Math.PI - diff\n  }\n\n  const dir = Math.sign(theta - thetaLast)\n  const steps = Math.round(diff / STEPS)\n  for (let i = 0; i < steps; i++) {\n    requestAnimationFrame(() => {\n      uniforms.theta.value += dir * STEPS\n      uniforms.amount.value = (uniforms.theta.value - thetaStart) / TOTAL\n      setKnob(uniforms.theta.value)\n\n      // render\n      rtt.render().paint()\n    })\n  }\n  thetaLast = theta\n  updateOutputColor()\n}\n\nconst onMouseMove = e => {\n  e.preventDefault()\n\n  const coords = getCoords(e)\n  const theta = getKnobTheta(coords)\n\n  renderMixer(theta)\n}\n\ndocument.addEventListener('mouseup', e => {\n  e.preventDefault()\n\n  knob.classList.remove('active')\n  document.removeEventListener('mousemove', onMouseMove)\n\n  // update base color\n  const col = getBaseColor()\n  uniforms.base.value = [col.r / 255, col.g / 255, col.b / 255]\n}, false)\n\nknob.addEventListener('mousedown', e => {\n  e.preventDefault()\n  const coords = getCoords(e)\n\n  uniforms.theta.value = thetaStart = thetaLast = getKnobTheta(coords)\n  uniforms.amount.value = 0\n\n  knob.classList.add('active')\n  document.addEventListener('mousemove', onMouseMove, false)\n}, false)\n\ndocument.querySelectorAll('#palette li').forEach(el => {\n  el.addEventListener('click', e => {\n    document.querySelector('#palette li.active').classList.remove('active')\n    e.target.classList.add('active')\n\n    const rgb = window.getComputedStyle(e.target).backgroundColor\n    const m = rgb.match(/^rgb\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/i)\n    if (m) {\n      uniforms.additive.value = [m[1] / 255, m[2] / 255, m[3] / 255]\n    }\n  })\n})\n"]}